<html>
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>

function hideAllSections() {
    $("#results").hide();
    $("#itemgroup").hide();
    $("#item").hide();
}

function findPart() {
    loadPart($("#code").val());
}

function runQuery() {
    query($("#queryBox").val());
}

function query(q) {
    $.getJSON("query?q=" + q, function(data) {
        hideAllSections();
        $("#results").show();
        $("#resultsBody").html("");

        for(item in data["results"]) {
           $("#resultsBody").append("<tr><td>"+
                                    "<a href='#' onClick=\"loadPart('"+ data["results"][item] + "');\">"
                                    + data["results"][item]
                                    +"</a></td></tr>");
        }
    });
}

function loadPart(code) {
        $.getJSON("part?q=" + code, function(data) {

        if(data["type"] == "Item") {
            hideAllSections();
            $("#item").show();

            for(var i in data) {
                $("#item_" + i).html(data[i]);
            }
        }else if(data["type"] == "ItemGroup") {
            hideAllSections();
            $("#itemgroup").show();

            for(var i in data) {
                $("#itemgroup_" + i).html(data[i]);
            }

        }
    });
}
</script>
<style>
div
{
    border-style:solid;
    border-width:1px;
    margin: 5px;
}
</style>

</head>

<body>
    <input type="text" id="code" value="1MM2U" /> <input type="button" href="#" onClick="findPart()" />

    <input type="text" id="queryBox" value="cond:broken" />
    <input type="button" href="#" onClick="runQuery()" />

    <div id="itemgroup" style="display:none">
        Item Group Details:
        <div id="itemgroup_code"></div>
        <div id="itemgroup_description"></div>
        <div id="itemgroup_name"></div>
        <div id="itemgroup_path"></div>
    </div>

    <div id="item" style="display:none">
        Item Details:
        <div id="item_code"></div>
        <div id="item_condition"></div>
        <div id="item_description"></div>
        <div id="item_labelled"></div>
        <div id="item_name"></div>
        <div id="item_path"></div>
        <div id="item_value"></div>
    </div>

    <div id="results" style="display:none">
        <table>
        <tr>
            <td>Code</td>
            <td>Name</td>
        </tr>
        <tbody id="resultsBody">

        </tbody>
        </table>

    </div>

</body>
</html>
